require("lua.ajaxresponse")require("connectdb")dbtable = "organismos"dbid = "idorganismo"dbsel = "*"if __FORM.oper then	local sql = ""	if __FORM.oper == "edit" then		sql = string.format("UPDATE %s SET name='%s', code='%s' WHERE %s='%s'", dbtable, __FORM.name, __FORM.code, dbid, __FORM.id)	elseif __FORM.oper == "add" then		sql = string.format("INSERT INTO %s (name, code) VALUES ('%s', '%s')",dbtable, __FORM.name, __FORM.code)	elseif __FORM.oper == "del" then		sql = string.format("DELETE FROM %s WHERE %s='%s'", dbtable, dbid, __FORM.id)	end	rslt, serr = doSQL(conMy, sql)	if serr then		ajax_error(json.encode(serr))	else		ajax_response(json.encode("ok"))	end	os.exit(0)endresp = {}resp.page = 0resp.total = 0resp.records = 0resp.rows = {}--fixWhere = string.format("idpersona='%s'",__FORM.idpersona)resp.records, serr = totalRegs(conMy, dbtable)if serr == nil then	resp.page = tonumber(__FORM.page) or 1	local limit = tonumber(__FORM.rows) or 10	if resp.records > 0 then		resp.total = math.ceil(resp.records/limit); 	else		resp.total  = 0; 	end	if resp.page > resp.total then		resp.page = resp.total	end	if resp.page < 1 then resp.page = 1 end	start = limit*resp.page - limit;	debugLog(limit.." ".. resp.page)	resp.rows = getRows(conMy,dbtable, dbid, dbsel, start, limit)endajax_responce(json.encode(resp))